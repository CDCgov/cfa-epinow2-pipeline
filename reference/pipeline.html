<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run an Rt Estimation Model Pipeline — orchestrate_pipeline • CFAEpiNow2Pipeline</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run an Rt Estimation Model Pipeline — orchestrate_pipeline"><meta name="description" content="This function runs a complete pipeline for fitting an Rt estimation model,
using the EpiNow2 model, based on a configuration file. The pipeline
processes the model, logs its progress, and handles errors by logging
warnings and setting the pipeline status. Output and logs are written to
the specified directories. Additionally, support for uploading logs and
outputs to a blob storage container is planned."><meta property="og:description" content="This function runs a complete pipeline for fitting an Rt estimation model,
using the EpiNow2 model, based on a configuration file. The pipeline
processes the model, logs its progress, and handles errors by logging
warnings and setting the pipeline status. Output and logs are written to
the specified directories. Additionally, support for uploading logs and
outputs to a blob storage container is planned."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CFAEpiNow2Pipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run an Rt Estimation Model Pipeline</h1>

      <div class="d-none name"><code>pipeline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function runs a complete pipeline for fitting an Rt estimation model,
using the <code>EpiNow2</code> model, based on a configuration file. The pipeline
processes the model, logs its progress, and handles errors by logging
warnings and setting the pipeline status. Output and logs are written to
the specified directories. Additionally, support for uploading logs and
outputs to a blob storage container is planned.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orchestrate_pipeline</span><span class="op">(</span></span>
<span>  <span class="va">config_path</span>,</span>
<span>  output_container <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config_container <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  input_dir <span class="op">=</span> <span class="st">"/input"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"/output"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">execute_model_logic</span><span class="op">(</span><span class="va">config</span>, <span class="va">input_dir</span>, <span class="va">output_dir</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-config-path">config_path<a class="anchor" aria-label="anchor" href="#arg-config-path"></a></dt>
<dd><p>A string specifying the file path to the JSON
configuration file.</p></dd>


<dt id="arg-output-container">output_container<a class="anchor" aria-label="anchor" href="#arg-output-container"></a></dt>
<dd><p>Optional. The name of the blob storage
container to which logs and outputs will be uploaded. If NULL, no upload
will occur.</p></dd>


<dt id="arg-config-container">config_container<a class="anchor" aria-label="anchor" href="#arg-config-container"></a></dt>
<dd><p>Optional. The name of the blob storage container
from which the config file will be downloaded.</p></dd>


<dt id="arg-input-dir">input_dir<a class="anchor" aria-label="anchor" href="#arg-input-dir"></a></dt>
<dd><p>A string specifying the directory to read inputs from. If
passing storage containers, this is where the files will be downloaded to.</p></dd>


<dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>A string specifying the directory where output, logs, and
other pipeline artifacts will be saved. Defaults to the root directory ("/").</p></dd>


<dt id="arg-config">config<a class="anchor" aria-label="anchor" href="#arg-config"></a></dt>
<dd><p>A Config object containing configuration settings for the
pipeline, including paths to data, exclusions, disease parameters, model
settings, and other necessary inputs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a boolean, TRUE For pipeline success and FALSE
otherwise. It writes the files:
directory will contain the following files:</p><ul><li><p>Model RDS file (<code>model.rds</code>)</p></li>
<li><p>Sample output in Parquet format (<code>&lt;task_id&gt;.parquet</code> in the <code>samples/</code>
directory)</p></li>
<li><p>Summary output in Parquet format (<code>&lt;task_id&gt;.parquet</code> in the <code>summaries/</code>
directory)</p></li>
<li><p>Log file (<code>logs.txt</code>) in the task directory</p></li>
</ul><p>Returns <code>TRUE</code> on success. Errors are caught by the outer pipeline
logic and logged accordingly.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function reads the configuration from a JSON file and uses this to set
up the job and task identifiers. It creates an output directory structure
based on these IDs and starts logging the process in a file. The main
pipeline process is handled by <code>execute_model_logic()</code>, with errors
caught and logged as warnings. The function will log the success or
failure of the run.</p>
<p>Logs are written to a file in the output directory, and console output is
also mirrored in this log file. Error handling is in place to capture any
issues during the pipeline execution and ensure they are logged
appropriately.</p>
<p>During the execution of the pipeline, the following output files are
expected to be generated:</p><ul><li><p><strong>Model Output</strong>: An RDS file of the fitted model is saved in the
task-specific directory (<code>model.rds</code>).</p></li>
<li><p><strong>Samples</strong>: Parquet files containing the model's sample outputs are saved
in a <code>samples</code> subdirectory, named using the <code>task_id</code> (e.g.,
<code>task_id.parquet</code>).</p></li>
<li><p><strong>Summaries</strong>: Parquet files summarizing the model's results are saved in
a <code>summaries</code> subdirectory, also named using the <code>task_id</code> (e.g.,
<code>task_id.parquet</code>).</p></li>
<li><p><strong>Logs</strong>: A <code>logs.txt</code> file is generated in the task directory, capturing
both console and error messages.</p></li>
</ul><p>The output directory structure will follow this format:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&lt;</span>output_dir<span class="sc">&gt;</span><span class="er">/</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>└── <span class="sc">&lt;</span>job_id<span class="sc">&gt;</span><span class="er">/</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    ├── samples<span class="sc">/</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    │   └── <span class="sc">&lt;</span>task_id<span class="sc">&gt;</span>.parquet</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    ├── summaries<span class="sc">/</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    │   └── <span class="sc">&lt;</span>task_id<span class="sc">&gt;</span>.parquet</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    └── tasks<span class="sc">/</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>        └── <span class="sc">&lt;</span>task_id<span class="sc">&gt;</span><span class="er">/</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>            ├── model.rds</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>            └── logs.txt</span></code></pre><p></p></div>
<p>This function performs the core model fitting process within the Rt
estimation pipeline, including reading data, applying exclusions, fitting
the model, and writing outputs such as model samples, summaries, and logs.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other pipeline:
<code><a href="fit_model.html">fit_model</a>()</code>,
<code><a href="format_stan_opts.html">format_stan_opts</a>()</code></p>
<p>Other pipeline:
<code><a href="fit_model.html">fit_model</a>()</code>,
<code><a href="format_stan_opts.html">format_stan_opts</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachary Susswein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

